{"ast":null,"code":"import _regeneratorRuntime from \"/Applications/XAMPP/xamppfiles/htdocs/neus/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Applications/XAMPP/xamppfiles/htdocs/neus/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"/Applications/XAMPP/xamppfiles/htdocs/neus/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { mergeProps as _mergeProps, createVNode as _createVNode } from \"vue\";\n// Styles\nimport \"./VDialog.css\";\n\n// Components\nimport { VDialogTransition } from \"../transitions/index.mjs\";\nimport { VDefaultsProvider } from \"../VDefaultsProvider/index.mjs\";\nimport { VOverlay } from \"../VOverlay/index.mjs\";\nimport { makeVOverlayProps } from \"../VOverlay/VOverlay.mjs\"; // Composables\nimport { forwardRefs } from \"../../composables/forwardRefs.mjs\";\nimport { useProxiedModel } from \"../../composables/proxiedModel.mjs\";\nimport { useScopeId } from \"../../composables/scopeId.mjs\"; // Utilities\nimport { computed, mergeProps, nextTick, ref, watch } from 'vue';\nimport { focusableChildren, genericComponent, IN_BROWSER, propsFactory, useRender } from \"../../util/index.mjs\"; // Types\nexport var makeVDialogProps = propsFactory(_objectSpread({\n  fullscreen: Boolean,\n  retainFocus: {\n    type: Boolean,\n    \"default\": true\n  },\n  scrollable: Boolean\n}, makeVOverlayProps({\n  origin: 'center center',\n  scrollStrategy: 'block',\n  transition: {\n    component: VDialogTransition\n  },\n  zIndex: 2400\n})), 'VDialog');\nexport var VDialog = genericComponent()({\n  name: 'VDialog',\n  props: makeVDialogProps(),\n  emits: {\n    'update:modelValue': function updateModelValue(value) {\n      return true;\n    }\n  },\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots;\n    var isActive = useProxiedModel(props, 'modelValue');\n    var _useScopeId = useScopeId(),\n      scopeId = _useScopeId.scopeId;\n    var overlay = ref();\n    function onFocusin(e) {\n      var _overlay$value, _overlay$value2;\n      var before = e.relatedTarget;\n      var after = e.target;\n      if (before !== after && (_overlay$value = overlay.value) !== null && _overlay$value !== void 0 && _overlay$value.contentEl && // We're the topmost dialog\n      (_overlay$value2 = overlay.value) !== null && _overlay$value2 !== void 0 && _overlay$value2.globalTop &&\n      // It isn't the document or the dialog body\n      ![document, overlay.value.contentEl].includes(after) &&\n      // It isn't inside the dialog body\n      !overlay.value.contentEl.contains(after)) {\n        var focusable = focusableChildren(overlay.value.contentEl);\n        if (!focusable.length) return;\n        var firstElement = focusable[0];\n        var lastElement = focusable[focusable.length - 1];\n        if (before === firstElement) {\n          lastElement.focus();\n        } else {\n          firstElement.focus();\n        }\n      }\n    }\n    if (IN_BROWSER) {\n      watch(function () {\n        return isActive.value && props.retainFocus;\n      }, function (val) {\n        val ? document.addEventListener('focusin', onFocusin) : document.removeEventListener('focusin', onFocusin);\n      }, {\n        immediate: true\n      });\n    }\n    watch(isActive, /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(val) {\n        var _overlay$value$conten, _overlay$value$activa;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return nextTick();\n            case 2:\n              if (val) {\n                (_overlay$value$conten = overlay.value.contentEl) === null || _overlay$value$conten === void 0 || _overlay$value$conten.focus({\n                  preventScroll: true\n                });\n              } else {\n                (_overlay$value$activa = overlay.value.activatorEl) === null || _overlay$value$activa === void 0 || _overlay$value$activa.focus({\n                  preventScroll: true\n                });\n              }\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n    var activatorProps = computed(function () {\n      return mergeProps({\n        'aria-haspopup': 'dialog',\n        'aria-expanded': String(isActive.value)\n      }, props.activatorProps);\n    });\n    useRender(function () {\n      var overlayProps = VOverlay.filterProps(props);\n      return _createVNode(VOverlay, _mergeProps({\n        \"ref\": overlay,\n        \"class\": ['v-dialog', {\n          'v-dialog--fullscreen': props.fullscreen,\n          'v-dialog--scrollable': props.scrollable\n        }, props[\"class\"]],\n        \"style\": props.style\n      }, overlayProps, {\n        \"modelValue\": isActive.value,\n        \"onUpdate:modelValue\": function onUpdateModelValue($event) {\n          return isActive.value = $event;\n        },\n        \"aria-modal\": \"true\",\n        \"activatorProps\": activatorProps.value,\n        \"role\": \"dialog\"\n      }, scopeId), {\n        activator: slots.activator,\n        \"default\": function _default() {\n          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n          return _createVNode(VDefaultsProvider, {\n            \"root\": \"VDialog\"\n          }, {\n            \"default\": function _default() {\n              var _slots$default;\n              return [(_slots$default = slots[\"default\"]) === null || _slots$default === void 0 ? void 0 : _slots$default.call.apply(_slots$default, [slots].concat(args))];\n            }\n          });\n        }\n      });\n    });\n    return forwardRefs({}, overlay);\n  }\n});","map":{"version":3,"names":["VDialogTransition","VDefaultsProvider","VOverlay","makeVOverlayProps","forwardRefs","useProxiedModel","useScopeId","computed","mergeProps","nextTick","ref","watch","focusableChildren","genericComponent","IN_BROWSER","propsFactory","useRender","makeVDialogProps","_objectSpread","fullscreen","Boolean","retainFocus","type","scrollable","origin","scrollStrategy","transition","component","zIndex","VDialog","name","props","emits","updateModelValue","value","setup","_ref","slots","isActive","_useScopeId","scopeId","overlay","onFocusin","e","_overlay$value","_overlay$value2","before","relatedTarget","after","target","contentEl","globalTop","document","includes","contains","focusable","length","firstElement","lastElement","focus","val","addEventListener","removeEventListener","immediate","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_overlay$value$conten","_overlay$value$activa","wrap","_callee$","_context","prev","next","preventScroll","activatorEl","stop","_x","apply","arguments","activatorProps","String","overlayProps","filterProps","_createVNode","_mergeProps","style","onUpdateModelValue","$event","activator","_default","_len","args","Array","_key","_slots$default","call","concat"],"sources":["../../../src/components/VDialog/VDialog.tsx"],"sourcesContent":["// Styles\nimport './VDialog.sass'\n\n// Components\nimport { VDialogTransition } from '@/components/transitions'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\nimport { VOverlay } from '@/components/VOverlay'\nimport { makeVOverlayProps } from '@/components/VOverlay/VOverlay'\n\n// Composables\nimport { forwardRefs } from '@/composables/forwardRefs'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { useScopeId } from '@/composables/scopeId'\n\n// Utilities\nimport { computed, mergeProps, nextTick, ref, watch } from 'vue'\nimport { focusableChildren, genericComponent, IN_BROWSER, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { Component } from 'vue'\nimport type { OverlaySlots } from '@/components/VOverlay/VOverlay'\n\nexport const makeVDialogProps = propsFactory({\n  fullscreen: Boolean,\n  retainFocus: {\n    type: Boolean,\n    default: true,\n  },\n  scrollable: Boolean,\n\n  ...makeVOverlayProps({\n    origin: 'center center' as const,\n    scrollStrategy: 'block' as const,\n    transition: { component: VDialogTransition as Component },\n    zIndex: 2400,\n  }),\n}, 'VDialog')\n\nexport const VDialog = genericComponent<OverlaySlots>()({\n  name: 'VDialog',\n\n  props: makeVDialogProps(),\n\n  emits: {\n    'update:modelValue': (value: boolean) => true,\n  },\n\n  setup (props, { slots }) {\n    const isActive = useProxiedModel(props, 'modelValue')\n    const { scopeId } = useScopeId()\n\n    const overlay = ref<VOverlay>()\n    function onFocusin (e: FocusEvent) {\n      const before = e.relatedTarget as HTMLElement | null\n      const after = e.target as HTMLElement | null\n\n      if (\n        before !== after &&\n        overlay.value?.contentEl &&\n        // We're the topmost dialog\n        overlay.value?.globalTop &&\n        // It isn't the document or the dialog body\n        ![document, overlay.value.contentEl].includes(after!) &&\n        // It isn't inside the dialog body\n        !overlay.value.contentEl.contains(after)\n      ) {\n        const focusable = focusableChildren(overlay.value.contentEl)\n\n        if (!focusable.length) return\n\n        const firstElement = focusable[0]\n        const lastElement = focusable[focusable.length - 1]\n\n        if (before === firstElement) {\n          lastElement.focus()\n        } else {\n          firstElement.focus()\n        }\n      }\n    }\n\n    if (IN_BROWSER) {\n      watch(() => isActive.value && props.retainFocus, val => {\n        val\n          ? document.addEventListener('focusin', onFocusin)\n          : document.removeEventListener('focusin', onFocusin)\n      }, { immediate: true })\n    }\n\n    watch(isActive, async val => {\n      await nextTick()\n      if (val) {\n        overlay.value!.contentEl?.focus({ preventScroll: true })\n      } else {\n        overlay.value!.activatorEl?.focus({ preventScroll: true })\n      }\n    })\n\n    const activatorProps = computed(() =>\n      mergeProps({\n        'aria-haspopup': 'dialog',\n        'aria-expanded': String(isActive.value),\n      }, props.activatorProps)\n    )\n\n    useRender(() => {\n      const overlayProps = VOverlay.filterProps(props)\n\n      return (\n        <VOverlay\n          ref={ overlay }\n          class={[\n            'v-dialog',\n            {\n              'v-dialog--fullscreen': props.fullscreen,\n              'v-dialog--scrollable': props.scrollable,\n            },\n            props.class,\n          ]}\n          style={ props.style }\n          { ...overlayProps }\n          v-model={ isActive.value }\n          aria-modal=\"true\"\n          activatorProps={ activatorProps.value }\n          role=\"dialog\"\n          { ...scopeId }\n        >\n          {{\n            activator: slots.activator,\n            default: (...args) => (\n              <VDefaultsProvider root=\"VDialog\">\n                { slots.default?.(...args) }\n              </VDefaultsProvider>\n            ),\n          }}\n        </VOverlay>\n      )\n    })\n\n    return forwardRefs({}, overlay)\n  },\n})\n\nexport type VDialog = InstanceType<typeof VDialog>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}