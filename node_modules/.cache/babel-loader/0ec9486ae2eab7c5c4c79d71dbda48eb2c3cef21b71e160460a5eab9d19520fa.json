{"ast":null,"code":"import _objectSpread from \"/Applications/XAMPP/xamppfiles/htdocs/neus/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.math.sign.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { createVNode as _createVNode, resolveDirective as _resolveDirective } from \"vue\";\n// Styles\nimport \"./VParallax.css\";\n\n// Components\nimport { VImg } from \"../VImg/index.mjs\"; // Composables\nimport { useDisplay } from \"../../composables/index.mjs\";\nimport { makeComponentProps } from \"../../composables/component.mjs\";\nimport { useIntersectionObserver } from \"../../composables/intersectionObserver.mjs\";\nimport { useResizeObserver } from \"../../composables/resizeObserver.mjs\"; // Utilities\nimport { computed, onBeforeUnmount, ref, watch, watchEffect } from 'vue';\nimport { clamp, genericComponent, getScrollParent, propsFactory, useRender } from \"../../util/index.mjs\"; // Types\nfunction floor(val) {\n  return Math.floor(Math.abs(val)) * Math.sign(val);\n}\nexport var makeVParallaxProps = propsFactory(_objectSpread({\n  scale: {\n    type: [Number, String],\n    \"default\": 0.5\n  }\n}, makeComponentProps()), 'VParallax');\nexport var VParallax = genericComponent()({\n  name: 'VParallax',\n  props: makeVParallaxProps(),\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots;\n    var _useIntersectionObser = useIntersectionObserver(),\n      intersectionRef = _useIntersectionObser.intersectionRef,\n      isIntersecting = _useIntersectionObser.isIntersecting;\n    var _useResizeObserver = useResizeObserver(),\n      resizeRef = _useResizeObserver.resizeRef,\n      contentRect = _useResizeObserver.contentRect;\n    var _useDisplay = useDisplay(),\n      displayHeight = _useDisplay.height;\n    var root = ref();\n    watchEffect(function () {\n      var _root$value;\n      intersectionRef.value = resizeRef.value = (_root$value = root.value) === null || _root$value === void 0 ? void 0 : _root$value.$el;\n    });\n    var scrollParent;\n    watch(isIntersecting, function (val) {\n      if (val) {\n        scrollParent = getScrollParent(intersectionRef.value);\n        scrollParent = scrollParent === document.scrollingElement ? document : scrollParent;\n        scrollParent.addEventListener('scroll', onScroll, {\n          passive: true\n        });\n        onScroll();\n      } else {\n        scrollParent.removeEventListener('scroll', onScroll);\n      }\n    });\n    onBeforeUnmount(function () {\n      var _scrollParent;\n      (_scrollParent = scrollParent) === null || _scrollParent === void 0 || _scrollParent.removeEventListener('scroll', onScroll);\n    });\n    watch(displayHeight, onScroll);\n    watch(function () {\n      var _contentRect$value;\n      return (_contentRect$value = contentRect.value) === null || _contentRect$value === void 0 ? void 0 : _contentRect$value.height;\n    }, onScroll);\n    var scale = computed(function () {\n      return 1 - clamp(+props.scale);\n    });\n    var frame = -1;\n    function onScroll() {\n      if (!isIntersecting.value) return;\n      cancelAnimationFrame(frame);\n      frame = requestAnimationFrame(function () {\n        var _root$value2;\n        var el = ((_root$value2 = root.value) === null || _root$value2 === void 0 ? void 0 : _root$value2.$el).querySelector('.v-img__img');\n        if (!el) return;\n        var scrollHeight = scrollParent instanceof Document ? document.documentElement.clientHeight : scrollParent.clientHeight;\n        var scrollPos = scrollParent instanceof Document ? window.scrollY : scrollParent.scrollTop;\n        var top = intersectionRef.value.getBoundingClientRect().top + scrollPos;\n        var height = contentRect.value.height;\n        var center = top + (height - scrollHeight) / 2;\n        var translate = floor((scrollPos - center) * scale.value);\n        var sizeScale = Math.max(1, (scale.value * (scrollHeight - height) + height) / height);\n        el.style.setProperty('transform', \"translateY(\".concat(translate, \"px) scale(\").concat(sizeScale, \")\"));\n      });\n    }\n    useRender(function () {\n      return _createVNode(VImg, {\n        \"class\": ['v-parallax', {\n          'v-parallax--active': isIntersecting.value\n        }, props[\"class\"]],\n        \"style\": props.style,\n        \"ref\": root,\n        \"cover\": true,\n        \"onLoadstart\": onScroll,\n        \"onLoad\": onScroll\n      }, slots);\n    });\n    return {};\n  }\n});","map":{"version":3,"names":["VImg","useDisplay","makeComponentProps","useIntersectionObserver","useResizeObserver","computed","onBeforeUnmount","ref","watch","watchEffect","clamp","genericComponent","getScrollParent","propsFactory","useRender","floor","val","Math","abs","sign","makeVParallaxProps","_objectSpread","scale","type","Number","String","VParallax","name","props","setup","_ref","slots","_useIntersectionObser","intersectionRef","isIntersecting","_useResizeObserver","resizeRef","contentRect","_useDisplay","displayHeight","height","root","_root$value","value","$el","scrollParent","document","scrollingElement","addEventListener","onScroll","passive","removeEventListener","_scrollParent","_contentRect$value","frame","cancelAnimationFrame","requestAnimationFrame","_root$value2","el","querySelector","scrollHeight","Document","documentElement","clientHeight","scrollPos","window","scrollY","scrollTop","top","getBoundingClientRect","center","translate","sizeScale","max","style","setProperty","concat","_createVNode"],"sources":["../../../src/components/VParallax/VParallax.tsx"],"sourcesContent":["// Styles\nimport './VParallax.sass'\n\n// Components\nimport { VImg } from '@/components/VImg'\n\n// Composables\nimport { useDisplay } from '@/composables'\nimport { makeComponentProps } from '@/composables/component'\nimport { useIntersectionObserver } from '@/composables/intersectionObserver'\nimport { useResizeObserver } from '@/composables/resizeObserver'\n\n// Utilities\nimport { computed, onBeforeUnmount, ref, watch, watchEffect } from 'vue'\nimport { clamp, genericComponent, getScrollParent, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { VImgSlots } from '@/components/VImg/VImg'\n\nfunction floor (val: number) {\n  return Math.floor(Math.abs(val)) * Math.sign(val)\n}\n\nexport const makeVParallaxProps = propsFactory({\n  scale: {\n    type: [Number, String],\n    default: 0.5,\n  },\n\n  ...makeComponentProps(),\n}, 'VParallax')\n\nexport const VParallax = genericComponent<VImgSlots>()({\n  name: 'VParallax',\n\n  props: makeVParallaxProps(),\n\n  setup (props, { slots }) {\n    const { intersectionRef, isIntersecting } = useIntersectionObserver()\n    const { resizeRef, contentRect } = useResizeObserver()\n    const { height: displayHeight } = useDisplay()\n\n    const root = ref<VImg>()\n\n    watchEffect(() => {\n      intersectionRef.value = resizeRef.value = root.value?.$el\n    })\n\n    let scrollParent: Element | Document\n    watch(isIntersecting, val => {\n      if (val) {\n        scrollParent = getScrollParent(intersectionRef.value)\n        scrollParent = scrollParent === document.scrollingElement ? document : scrollParent\n        scrollParent.addEventListener('scroll', onScroll, { passive: true })\n        onScroll()\n      } else {\n        scrollParent.removeEventListener('scroll', onScroll)\n      }\n    })\n\n    onBeforeUnmount(() => {\n      scrollParent?.removeEventListener('scroll', onScroll)\n    })\n\n    watch(displayHeight, onScroll)\n    watch(() => contentRect.value?.height, onScroll)\n\n    const scale = computed(() => {\n      return 1 - clamp(+props.scale)\n    })\n\n    let frame = -1\n    function onScroll () {\n      if (!isIntersecting.value) return\n\n      cancelAnimationFrame(frame)\n      frame = requestAnimationFrame(() => {\n        const el: HTMLElement | null = (root.value?.$el as Element).querySelector('.v-img__img')\n        if (!el) return\n\n        const scrollHeight = scrollParent instanceof Document ? document.documentElement.clientHeight : scrollParent.clientHeight\n        const scrollPos = scrollParent instanceof Document ? window.scrollY : scrollParent.scrollTop\n        const top = intersectionRef.value!.getBoundingClientRect().top + scrollPos\n        const height = contentRect.value!.height\n\n        const center = top + (height - scrollHeight) / 2\n        const translate = floor((scrollPos - center) * scale.value)\n        const sizeScale = Math.max(1, (scale.value * (scrollHeight - height) + height) / height)\n\n        el.style.setProperty('transform', `translateY(${translate}px) scale(${sizeScale})`)\n      })\n    }\n\n    useRender(() => (\n      <VImg\n        class={[\n          'v-parallax',\n          { 'v-parallax--active': isIntersecting.value },\n          props.class,\n        ]}\n        style={ props.style }\n        ref={ root }\n        cover\n        onLoadstart={ onScroll }\n        onLoad={ onScroll }\n        v-slots={ slots }\n      />\n    ))\n\n    return {}\n  },\n})\n\nexport type VParallax = InstanceType<typeof VParallax>\n"],"mappings":";;;;;AAAA;AACA;;AAEA;AAAA,SACSA,IAAI,6BAEb;AAAA,SACSC,UAAU;AAAA,SACVC,kBAAkB;AAAA,SAClBC,uBAAuB;AAAA,SACvBC,iBAAiB,gDAE1B;AACA,SAASC,QAAQ,EAAEC,eAAe,EAAEC,GAAG,EAAEC,KAAK,EAAEC,WAAW,QAAQ,KAAK;AAAA,SAC/DC,KAAK,EAAEC,gBAAgB,EAAEC,eAAe,EAAEC,YAAY,EAAEC,SAAS,gCAE1E;AAGA,SAASC,KAAKA,CAAEC,GAAW,EAAE;EAC3B,OAAOC,IAAI,CAACF,KAAK,CAACE,IAAI,CAACC,GAAG,CAACF,GAAG,CAAC,CAAC,GAAGC,IAAI,CAACE,IAAI,CAACH,GAAG,CAAC;AACnD;AAEA,OAAO,IAAMI,kBAAkB,GAAGP,YAAY,CAAAQ,aAAA;EAC5CC,KAAK,EAAE;IACLC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;IACtB,WAAS;EACX;AAAC,GAEEvB,kBAAkB,CAAC,IACrB,WAAW,CAAC;AAEf,OAAO,IAAMwB,SAAS,GAAGf,gBAAgB,CAAY,CAAC,CAAC;EACrDgB,IAAI,EAAE,WAAW;EAEjBC,KAAK,EAAER,kBAAkB,CAAC,CAAC;EAE3BS,KAAK,WAAAA,MAAED,KAAK,EAAAE,IAAA,EAAa;IAAA,IAATC,KAAA,GAAOD,IAAA,CAAPC,KAAA;IACd,IAAAC,qBAAA,GAA4C7B,uBAAuB,CAAC,CAAC;MAA7D8B,eAAe,GAAAD,qBAAA,CAAfC,eAAe;MAAEC,cAAA,GAAAF,qBAAA,CAAAE,cAAA;IACzB,IAAAC,kBAAA,GAAmC/B,iBAAiB,CAAC,CAAC;MAA9CgC,SAAS,GAAAD,kBAAA,CAATC,SAAS;MAAEC,WAAA,GAAAF,kBAAA,CAAAE,WAAA;IACnB,IAAAC,WAAA,GAAkCrC,UAAU,CAAC,CAAC;MAA9BsC,aAAA,GAAAD,WAAA,CAARE,MAAM;IAEd,IAAMC,IAAI,GAAGlC,GAAG,CAAO,CAAC;IAExBE,WAAW,CAAC,YAAM;MAAA,IAAAiC,WAAA;MAChBT,eAAe,CAACU,KAAK,GAAGP,SAAS,CAACO,KAAK,IAAAD,WAAA,GAAGD,IAAI,CAACE,KAAK,cAAAD,WAAA,uBAAVA,WAAA,CAAYE,GAAG;IAC3D,CAAC,CAAC;IAEF,IAAIC,YAAgC;IACpCrC,KAAK,CAAC0B,cAAc,EAAE,UAAAlB,GAAG,EAAI;MAC3B,IAAIA,GAAG,EAAE;QACP6B,YAAY,GAAGjC,eAAe,CAACqB,eAAe,CAACU,KAAK,CAAC;QACrDE,YAAY,GAAGA,YAAY,KAAKC,QAAQ,CAACC,gBAAgB,GAAGD,QAAQ,GAAGD,YAAY;QACnFA,YAAY,CAACG,gBAAgB,CAAC,QAAQ,EAAEC,QAAQ,EAAE;UAAEC,OAAO,EAAE;QAAK,CAAC,CAAC;QACpED,QAAQ,CAAC,CAAC;MACZ,CAAC,MAAM;QACLJ,YAAY,CAACM,mBAAmB,CAAC,QAAQ,EAAEF,QAAQ,CAAC;MACtD;IACF,CAAC,CAAC;IAEF3C,eAAe,CAAC,YAAM;MAAA,IAAA8C,aAAA;MACpB,CAAAA,aAAA,GAAAP,YAAY,cAAAO,aAAA,eAAZA,aAAA,CAAcD,mBAAmB,CAAC,QAAQ,EAAEF,QAAQ,CAAC;IACvD,CAAC,CAAC;IAEFzC,KAAK,CAAC+B,aAAa,EAAEU,QAAQ,CAAC;IAC9BzC,KAAK,CAAC;MAAA,IAAA6C,kBAAA;MAAA,QAAAA,kBAAA,GAAMhB,WAAW,CAACM,KAAK,cAAAU,kBAAA,uBAAjBA,kBAAA,CAAmBb,MAAM;IAAA,GAAES,QAAQ,CAAC;IAEhD,IAAM3B,KAAK,GAAGjB,QAAQ,CAAC,YAAM;MAC3B,OAAO,CAAC,GAAGK,KAAK,CAAC,CAACkB,KAAK,CAACN,KAAK,CAAC;IAChC,CAAC,CAAC;IAEF,IAAIgC,KAAK,GAAG,CAAC,CAAC;IACd,SAASL,QAAQA,CAAA,EAAI;MACnB,IAAI,CAACf,cAAc,CAACS,KAAK,EAAE;MAE3BY,oBAAoB,CAACD,KAAK,CAAC;MAC3BA,KAAK,GAAGE,qBAAqB,CAAC,YAAM;QAAA,IAAAC,YAAA;QAClC,IAAMC,EAAsB,GAAG,EAAAD,YAAA,GAAChB,IAAI,CAACE,KAAK,cAAAc,YAAA,uBAAVA,YAAA,CAAYb,GAAG,EAAae,aAAa,CAAC,aAAa,CAAC;QACxF,IAAI,CAACD,EAAE,EAAE;QAET,IAAME,YAAY,GAAGf,YAAY,YAAYgB,QAAQ,GAAGf,QAAQ,CAACgB,eAAe,CAACC,YAAY,GAAGlB,YAAY,CAACkB,YAAY;QACzH,IAAMC,SAAS,GAAGnB,YAAY,YAAYgB,QAAQ,GAAGI,MAAM,CAACC,OAAO,GAAGrB,YAAY,CAACsB,SAAS;QAC5F,IAAMC,GAAG,GAAGnC,eAAe,CAACU,KAAK,CAAE0B,qBAAqB,CAAC,CAAC,CAACD,GAAG,GAAGJ,SAAS;QAC1E,IAAMxB,MAAM,GAAGH,WAAW,CAACM,KAAK,CAAEH,MAAM;QAExC,IAAM8B,MAAM,GAAGF,GAAG,GAAG,CAAC5B,MAAM,GAAGoB,YAAY,IAAI,CAAC;QAChD,IAAMW,SAAS,GAAGxD,KAAK,CAAC,CAACiD,SAAS,GAAGM,MAAM,IAAIhD,KAAK,CAACqB,KAAK,CAAC;QAC3D,IAAM6B,SAAS,GAAGvD,IAAI,CAACwD,GAAG,CAAC,CAAC,EAAE,CAACnD,KAAK,CAACqB,KAAK,IAAIiB,YAAY,GAAGpB,MAAM,CAAC,GAAGA,MAAM,IAAIA,MAAM,CAAC;QAExFkB,EAAE,CAACgB,KAAK,CAACC,WAAW,CAAC,WAAW,gBAAAC,MAAA,CAAgBL,SAAU,gBAAAK,MAAA,CAAYJ,SAAU,MAAE,CAAC;MACrF,CAAC,CAAC;IACJ;IAEA1D,SAAS,CAAC;MAAA,OAAA+D,YAAA,CAAA7E,IAAA;QAAA,SAEC,CACL,YAAY,EACZ;UAAE,oBAAoB,EAAEkC,cAAc,CAACS;QAAM,CAAC,EAC9Cf,KAAK,SAAM,CACZ;QAAA,SACOA,KAAK,CAAC8C,KAAK;QAAA,OACbjC,IAAI;QAAA;QAAA,eAEIQ,QAAQ;QAAA,UACbA;MAAQ,GACPlB,KAAK,CAElB;IAAA,EAAC;IAEF,OAAO,CAAC,CAAC;EACX;AACF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}